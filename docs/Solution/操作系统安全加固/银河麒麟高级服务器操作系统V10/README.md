# 银河麒麟高级服务器操作系统V10 安全加固参考

## 账户口令

### 屏蔽系统账户

#### 说明

除了用户账户外，其他账号成为系统账户。系统账户仅系统内部使用，禁止用于登录系统或其他操作，因此屏蔽系统账户的登录权限。

#### 实现

将系统账户的Shell修改为`/sbin/nologin`。

```bash
usermod -L -s /sbin/nologin @systemaccount
```

> $systemaccount 指系统账户

### 限制使用su命令的账户

#### 说明

`su`命令用于在不同账户之间切换。为了增强系统安全性，有必要对`su`命令的使用权进行控制，只允许root和wheel群组的账户使用su命令，限制其他账户使用。

#### 实现

`su`命令的使用控制通过修改`/etc/pam.d/su`文件实现，配置如下：

```bash
auth    required    pam_wheel.so use_uid
```

> use_id 基于当前用户的uid。

### 加固su命令

#### 说明

为了增强系统安全性，防止使用`su`切换用户时将当前用户环境变量带入其他环境，设置系统在使用`su`切换用户时初始化`PATH`

#### 实现

通过修改`/etc/login.defs`实现，配置如下：

```bash
ALWAYS_SET_PATH=yes
```

### 设置口令复杂度

#### 说明

用户可以通过修改对应配置文件设置口令的复杂度要求，建议用户根据实际情况设置口令复杂度。

#### 实现

口令复杂度通过修改`/etc/security/pwquality.conf`配置文件实现

#### 配置项说明

- difok 代表不得与上次口令相同的字符个数；
- minlen 为口令最小长度；
- dcredit 为口令中最少包含数字的个数；
- ucredit 为口令中最少包含大写字母的个数；
- lcredit 为口令中最少包含小写字母的个数；
- ocredit 为口令中最少包含特殊字符的个数；
- maxrepeat 为口令中相同字符出现最多的次数；
- usercheck 为检测口令是否与用户名相似。

### 设置口令有效期

#### 说明

出于系统安全性考虑，建议设置口令有效期限，且口令到期前通知用户更改口令。

#### 实现

口令有效期的设置通过修改`/etc/login.defs`文件实现。

#### 配置项说明

- PASS_MAX_DAYS 口令最大有效期
- PASS_MIN_DAYS 两次修改口令的最小间隔时间
- PASS_WARN_AGE 口令过期前开始提示天数

> `login.defs`是设置用户账号限制的文件，可以配置口令的最大过期天数、最大长度约束等。该文件里的配置对root用户无效。
>
> 如果`/etc/shadow`文件里有相同的选项，则以`/etc/shadow`配置为准，即`/etc/shadow`的配置优先级高于`/etc/login.defs`。
>
> 口令过期后用户重新登录时，提示口令过期并强制要求修改，不修改则无法进入系统。